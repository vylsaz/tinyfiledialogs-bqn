âŸ¨ os, cpu âŸ© â† â€¢platform
# https://sourceforge.net/p/tinyfiledialogs/code/ci/master/tree/dll_cs_lua_R_fortran_pascal/
dll â† ({ âŸ¨âŸ©: ""; âŠ‘ð•© }â€¢args)â€¢file.At {
    { "windows":
        { "x86-64": "tinyfiledialogs64.dll"
        ; "x86": "tinyfiledialogs32.dll"
        } cpu.arch
    ; "linux":
        { "x86-64": "tinyfiledialogsLinux64.so"
        ; "x86": "tinyfiledialogsLinux86.so"
        } cpu.arch
    ; "darwin":
        { "x86-64": "tinyfiledialogsIntel.dylib"
        ; "aarch64": "tinyfiledialogsAppleSilicon.dylib"
        } cpu.arch
    } os
}

void â† {t â‡ ""}
char â† {t â‡ "i8:c8"}
int  â† {t â‡ "i32"}
u8   â† {t â‡ "u8"}
Ptr  â† {t â‡ "*"âˆ¾ð•©.t}
Out  â† {t â‡ "&"âˆ¾ð•©.t}

rawPtr â† {t â‡ "*:i32"}

cstr â† {t â‡ (Ptr char).t}
cstrOrNull â† {t â‡ rawPtr.t}

ptrPtr â† {t â‡ "*i32"}

ToCstr â† âˆ¾âŸœ@ â€¢ToUTF8

null â† 0â€¿0

strlen â† @â€¢FFI "i64"â€¿"strlen"â€¿(">"âˆ¾cstrOrNull.t)
memcpy â† @â€¢FFI "&"â€¿"memcpy"â€¿"&i8"â€¿(cstrOrNull.t)â€¿"i64"

ReadCstr â† { nullâ‰¡ð•©? @;
    n â† Strlen ð•©
    utf8 â† Memcpy âŸ¨ nâ¥Š0, ð•©, n âŸ©
    â€¢FromUTF8 utf8
}

_ffiWith_ â† {
    n â† @â‰¡ð•©
    s â† 0==ð•©
    c â† âˆ¨Â´â¥Šcs â† cstr=ð•©
    wc â† cstrOrNullâ‰¡ð•¨
    r â† ð•˜ â€¢FFI âŸ¨ð•¨.t, ð•—âŸ©âˆ¾{
        n? âŸ¨âŸ©;
        s? âŸ¨">"âˆ¾ð•©.tâŸ©; 
        {ð•©.t}Â¨ð•©
    }ð•©
    {
        wc? ReadCstr ð•;
        ð•©
    }{
        n? {ð•Š: R âŸ¨âŸ©}; 
        sâˆ§c? {R ToCstr ð•©};
        c? {R (csâŠâŸ¨ âŠ¢, ToCstr âŸ©){ð•Žð•©}Â¨ð•©};
        r
    }
}

free â† void "free"_ffiWith_@ rawPtr
strdup â† rawPtr {osâ‰¡"windows"? "_strdup"; "strdup"}_ffiWith_@ cstr

_ffi â† {ð”½ _ffiWith_ dll}

tinyfd_getGlobalChar â† cstrOrNull "tinyfd_getGlobalChar"_ffi cstr
tinyfd_getGlobalInt â† int "tinyfd_getGlobalInt"_ffi cstr
tinyfd_setGlobalInt â† int "tinyfd_setGlobalInt"_ffi âŸ¨ cstr, int âŸ©

#  aCharVariableName: "tinyfd_version" "tinyfd_needs" "tinyfd_response"
#  aIntVariableName : "tinyfd_verbose" "tinyfd_silent" "tinyfd_allowCursesDialogs"
#                     "tinyfd_forceConsole" "tinyfd_assumeGraphicDisplay" "tinyfd_winUtf8"

tinyfd_beep â† void "tinyfd_beep"_ffi @

# if you pass "tinyfd_query" as aTitle,
# the functions will not display the dialogs
# but will return 0 for console mode, 1 for graphic mode.
# tinyfd_response is then filled with the retain solution.
# possible values for tinyfd_response are (all lowercase)
# for graphic mode:
#   windows_wchar windows applescript kdialog zenity zenity3 yad matedialog
#   shellementary qarma shanty boxer python2-tkinter python3-tkinter python-dbus
#   perl-dbus gxmessage gmessage xmessage xdialog gdialog dunst
# for console mode:
#   dialog whiptail basicinput no_solution
tinyfd_query â† int "tinyfd_notifyPopup"_ffi âŸ¨
    cstr,   # title
    rawPtr, # message
    rawPtr, # icon type ("info" "warning" "error")
âŸ©
tinyfd_notifyPopup â† void "tinyfd_notifyPopup"_ffi âŸ¨
    cstr,   # title
    cstr,   # message
    cstr,   # icon type ("info" "warning" "error")
âŸ©
tinyfd_messageBox â† int "tinyfd_messageBox"_ffi âŸ¨
    cstr,   # title
    cstr,   # message
    cstr,   # dialog type ("ok" "okcancel" "yesno" "yesnocancel")
    cstr,   # icon type ("info" "warning" "error" "question")
    int,    # default button
âŸ© # 0 for cancel/no , 1 for ok/yes , 2 for no in yesnocancel
tinyfd_inputBox â† cstrOrNull "tinyfd_inputBox"_ffi âŸ¨
    cstr,   # title
    cstr,   # message
    cstr,   # default input (NULL = passwordBox, "" = inputbox)
âŸ© # returns NULL on cancel
tinyfd_passwordBox â† cstrOrNull "tinyfd_inputBox"_ffi âŸ¨
    cstr,   # title
    cstr,   # message
    rawPtr, # default input (NULL = passwordBox, "" = inputbox)
âŸ© # returns NULL on cancel
tinyfd_saveFileDialog â† cstrOrNull "tinyfd_saveFileDialog"_ffi âŸ¨
    cstr,   # title
    cstr,   # default path and/or file (ends with / to set only a directory)
    int,    # num of filter patterns
    ptrPtr, # filter patterns (like {"*.txt"})
    cstr,   # single filter description
âŸ© # returns NULL on cancel
tinyfd_openFileDialog â† cstrOrNull "tinyfd_openFileDialog"_ffi âŸ¨
    cstr,   # title
    cstr,   # default path and/or file (ends with / to set only a directory)
    int,    # num of filter patterns
    ptrPtr, # filter patterns (like {"*.png","*.jpg"})
    cstr,   # single filter description
    int,    # allow multiple selects
âŸ© # returns NULL on cancel
# in case of multiple files, the separator is |
tinyfd_selectFolderDialog â† cstrOrNull "tinyfd_selectFolderDialog"_ffi âŸ¨
    cstr,   # title
    cstr,   # default path
âŸ© # returns NULL on cancel
tinyfd_colorChooser â† rawPtr "tinyfd_colorChooser"_ffi âŸ¨
    cstr,   # title
    rawPtr, # default hex RGB or NULL
    Ptr u8, # default RGB[3]
    Out u8, # result RGB[3]
âŸ©
# aDefaultRGB is used only if aDefaultHexRGB is absent
# aDefaultRGB and aoResultRGB can be the same array
# returns NULL on cancel
# returns the hexcolor as a string
# aoResultRGB also contains the result

version â‡ Tinyfd_getGlobalChar "tinyfd_version"
needs â‡ Tinyfd_GetGlobalChar "tinyfd_needs"

# GetGlobalChar â† Tinyfd_GetGlobalChar
# GetGlobalInt â† Tinyfd_GetGlobalInt
# SetGlobalInt â† { !Â¯1â‰ Tinyfd_SetGlobalInt âŸ¨ ð•¨, ð•© âŸ© }

GlobalInt â† { name ð•Š n:
    { @: Tinyfd_GetGlobalInt name
    ; 0: !Â¯1â‰ Tinyfd_SetGlobalInt âŸ¨ name, 0 âŸ©
    ; 1: !Â¯1â‰ Tinyfd_SetGlobalInt âŸ¨ name, 1 âŸ©
    }n
}

Verbose â‡ "tinyfd_verbose"âŠ¸GlobalInt
Silent â‡ "tinyfd_silent"âŠ¸GlobalInt
AllowCursesDialogs â‡ "tinyfd_allowCursesDialogs"âŠ¸GlobalInt
ForceConsole â‡ "tinyfd_forceConsole"âŠ¸GlobalInt
AssumeGraphicDisplay â‡ "tinyfd_assumeGraphicDisplay"âŠ¸GlobalInt


Beep â‡ Tinyfd_beep

Query â‡ { ð•Š:
    r â† Tinyfd_query âŸ¨ "tinyfd_query", null, null âŸ©
    âŸ¨ r, Tinyfd_GetGlobalChar "tinyfd_response" âŸ©
}

_notifyPopup â‡ { ð”½ _ð•£ ð•©: "" ð”½ _ð•£ ð•©;
title iconType _ð•£ message:
    Tinyfd_notifyPopup âŸ¨ title, message, iconType âŸ©
}

_messageBox_ â‡ { ð”½ _ð•£_ ð”¾ ð•©: "" ð”½ _ð•£_ ð”¾ ð•©;
title iconType _ð•£_ dialogTypeâ€¿defualtButton message:
    Tinyfd_messageBox âŸ¨ title, message, dialogType, iconType, defualtButton âŸ©
}

_inputBox â‡ { ð”½ _ð•£ ð•©: "" ð”½ _ð•£ ð•©;
title defaultInput _ð•£ message:
    Tinyfd_inputBox âŸ¨ title, message, defaultInput âŸ©
}

PasswordBox â‡ { ð•Š ð•©: "" ð•Š ð•©;
title ð•Š message:
    Tinyfd_passwordBox âŸ¨ title, message, null âŸ©
}

_saveFileDialog â‡ { ð”½ _ð•£ ð•©: "" ð”½ _ð•£ ð•©;
title descâ€¿patt _ð•£ path:
    p â† StrdupÂ¨patt
    r â† Tinyfd_saveFileDialog âŸ¨ title, path, â‰ p, âˆ¾p, desc âŸ©
    FreeÂ¨p
    r
}

_openFileDialogRaw_ â‡ { ð”½ _ð•£_ ð”¾ ð•©: "" ð”½ _ð•£_ ð”¾ ð•©;
title descâ€¿patt _ð•£_ allowMultiSelects path:
    p â† StrdupÂ¨patt
    r â† Tinyfd_openFileDialog âŸ¨ title, path, â‰ p, âˆ¾p, desc, allowMultiSelects âŸ©
    FreeÂ¨p
    r
}

_openFileDialogMulti â‡ {
    { ð•©â‰¡@? @; '|'((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢) ð•© } ð•¨ ð”½ _openFileDialogRaw_ 1 ð•©
}

_openFileDialog â‡ { ð•¨ ð”½ _openFileDialogRaw_ 0 ð•© }

SelectFolderDialog â‡ { ð•Š ð•©: "" ð•Š ð•©;
title ð•Š path:
    Tinyfd_selectFolderDialog âŸ¨ title, path âŸ©
}

ColorChooserRaw â† { ð•Š ð•©: "" ð•Š ð•©;
title ð•Š default:
    defaultStrâ€¿defaultRGB â† {
    '#'â‰¡âŠ‘default? âŸ¨ Strdup ToCstr default, 3â¥Š0 âŸ©
    ; 3â‰¥â‰ default? âŸ¨ null, 3â†‘default âŸ©
    ; !"unknown color "âˆ¾â€¢Fmt default
    }
    ptrâ€¿rgb â† Tinyfd_colorChooser âŸ¨ title, defaultStr, defaultRGB, 3â¥Š0 âŸ©
    Free defaultStr
    âŸ¨ ReadCstr ptr, rgb âŸ©
}

ColorChooser â‡ {
    strâ€¿rgb â† ð•¨ ColorChooserRaw ð•©
    { strâ‰¡@? @; rgb }
}

ColorChooserHex â‡ { âŠ‘ ð•¨ ColorChooserRaw ð•© }

# from original header
#
# /* SPDX-License-Identifier: Zlib
# Copyright (c) 2014 - 2025 Guillaume Vareille http://ysengrin.com
# 	 ____________________________________________________________________
# 	|                                                                    |
# 	| 100% compatible C C++  ->  You can rename tinfiledialogs.c as .cpp |
# 	|____________________________________________________________________|
# 
# ********* TINY FILE DIALOGS OFFICIAL WEBSITE IS ON SOURCEFORGE *********
#   _________
#  /         \ tinyfiledialogs.h v3.21.2 [Oct 25, 2025]
#  |tiny file| Unique header file created [November 9, 2014]
#  | dialogs |
#  \____  ___/ http://tinyfiledialogs.sourceforge.net
#       \|     git clone http://git.code.sf.net/p/tinyfiledialogs/code tinyfd
#  ____________________________________________
# |                                            |
# |   email: tinyfiledialogs at ysengrin.com   |
# |____________________________________________|
#  ________________________________________________________________________________
# |  ____________________________________________________________________________  |
# | |                                                                            | |
# | |  - in tinyfiledialogs, char is UTF-8 by default (since v3.6)               | |
# | |                                                                            | |
# | | on windows:                                                                | |
# | |  - for UTF-16, use the wchar_t functions at the bottom of the header file  | |
# | |                                                                            | |
# | |  - _wfopen() requires wchar_t                                              | |
# | |  - fopen() uses char but expects ASCII or MBCS (not UTF-8)                 | |
# | |  - if you want char to be MBCS: set tinyfd_winUtf8 to 0                    | |
# | |                                                                            | |
# | |  - alternatively, tinyfiledialogs provides                                 | |
# | |                        functions to convert between UTF-8, UTF-16 and MBCS | |
# | |____________________________________________________________________________| |
# |________________________________________________________________________________|
# 
# If you like tinyfiledialogs, please upvote my stackoverflow answer
# https://stackoverflow.com/a/47651444
# 
# - License -
# This software is provided 'as-is', without any express or implied
# warranty.  In no event will the authors be held liable for any damages
# arising from the use of this software.
# Permission is granted to anyone to use this software for any purpose,
# including commercial applications, and to alter it and redistribute it
# freely, subject to the following restrictions:
# 1. The origin of this software must not be misrepresented; you must not
# claim that you wrote the original software.  If you use this software
# in a product, an acknowledgment in the product documentation would be
# appreciated but is not required.
# 2. Altered source versions must be plainly marked as such, and must not be
# misrepresented as being the original software.
# 3. This notice may not be removed or altered from any source distribution.
# 
#      __________________________________________
#     |  ______________________________________  |
#     | |                                      | |
#     | | DO NOT USE USER INPUT IN THE DIALOGS | |
#     | |______________________________________| |
#     |__________________________________________|
# */
